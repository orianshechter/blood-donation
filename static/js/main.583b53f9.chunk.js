(this["webpackJsonpmda-blood"]=this["webpackJsonpmda-blood"]||[]).push([[0],{105:function(e,t,n){},106:function(e,t,n){},108:function(e,t,n){},150:function(e,t,n){},153:function(e,t,n){"use strict";n.r(t);var s=n(0),r=n.n(s),c=n(13),a=n.n(c),i=(n(95),n(10)),o=(n(96),n(39));n(98);function d(e,t,n,s){var r=j(n-e),c=j(s-t),a=Math.sin(r/2)*Math.sin(r/2)+Math.cos(j(e))*Math.cos(j(n))*Math.sin(c/2)*Math.sin(c/2);return 6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))}function j(e){return e*(Math.PI/180)}var l=n(7);function u(e){var t=new Date(e).getHours(),n=new Date(e).getMinutes();return 0===n&&(n="00"),t+":"+n}function b(e){return["\u05d9\u05d5\u05dd \u05e8\u05d0\u05e9\u05d5\u05df","\u05d9\u05d5\u05dd \u05e9\u05e0\u05d9","\u05d9\u05d5\u05dd \u05e9\u05dc\u05d9\u05e9\u05d9","\u05d9\u05d5\u05dd \u05e8\u05d1\u05d9\u05e2\u05d9","\u05d9\u05d5\u05dd \u05d7\u05de\u05d9\u05e9\u05d9","\u05d9\u05d5\u05dd \u05e9\u05d9\u05e9\u05d9","\u05d9\u05d5\u05dd \u05e9\u05d1\u05ea"][new Date(e).getDay()]}function O(e){return new Date(e).toLocaleString("he-il").split(",")[0].replaceAll(".","/")}var p=n(3),m=Object(s.createContext)(),f=function(e){var t=e.children,n=Object(s.useState)(null),r=Object(i.a)(n,2),c=r[0],a=r[1],o=Object(s.useState)(null),d=Object(i.a)(o,2),j=d[0],u=d[1],b=Object(s.useState)(null),O=Object(i.a)(b,2),f=O[0],h=O[1],x=Object(s.useState)(null),v=Object(i.a)(x,2),g=v[0],C=v[1];return Object(s.useEffect)((function(){var e=new XMLHttpRequest;e.open("GET","https://raw.githubusercontent.com/orianshechter/blood-donation-addresses/main/addresses.json",!0),e.onload=function(){if(200===this.status)try{var e=JSON.parse(this.response).filter((function(e){return!!e.address.location&&!(new Date(e.times[0].timestamp_end)<new Date&&1===e.times.length)}));e=e.map((function(e){if(e.address.location)return new Date(e.times[0].timestamp_end)<new Date&&e.times.shift(),Object(l.a)(Object(l.a)({},e),{},{isPopupOpen:!1,isListHovered:!1})})),u(e),a(e)}catch(t){console.log(t.message)}else 400===this.status&&(a([]),u([]))},e.send()}),[]),Object(s.useEffect)((function(){a(f?function(e,t,n){n||(n=new Date).setDate(t.getDate()+30);var s=new Date(n);s.setDate(n.getDate()+1);var r=e.map((function(e){var n=e.times.filter((function(e){return t<=new Date(e.timestamp_start)&&s>=new Date(e.timestamp_end)}));return Object(l.a)(Object(l.a)({},e),{},{times:n})}));return r.filter((function(e){return e.times.length>0}))}(j,f,g):j)}),[f,g,j]),Object(p.jsx)(m.Provider,{value:{addressesObjects:c,setAddressesObjets:a,setAllAddressesObjects:u,onMouseAddressHover:function(e){a((function(t){return t.map((function(t){return t===e?Object(l.a)(Object(l.a)({},e),{},{isListHovered:!0}):Object(l.a)(Object(l.a)({},t),{},{isListHovered:!1})}))}))},onMouseAddressOut:function(e){a((function(t){return t.map((function(t){return t===e?Object(l.a)(Object(l.a)({},e),{},{isListHovered:!1}):t}))}))},startDate:f,endDate:g,setStartDate:h,setEndDate:C},children:t})},h=Object(s.createContext)(),x=[31.5,34.65],v=function(e){var t=e.children,n=Object(s.useState)(x),r=Object(i.a)(n,2),c=r[0],a=r[1],o=Object(s.useState)(7),d=Object(i.a)(o,2),j=d[0],l=d[1],u=Object(s.useState)(x),b=Object(i.a)(u,2),O=b[0],m=b[1];function f(e){a([e.coords.latitude,e.coords.longitude]),m([e.coords.latitude,e.coords.longitude]),l(11)}function v(){console.log("error")}function g(){navigator.geolocation.getCurrentPosition(f,v,{enableHighAccuracy:!0})}return Object(s.useEffect)((function(){setTimeout(g,2e3)}),[]),Object(p.jsx)(h.Provider,{value:{mapCenter:c,setMapCenter:a,mapZoom:j,setMapZoom:l,setCenterToCurrentLocation:g,locationsCenter:O,setLocationsCenter:m},children:t})},g=n(75),C=n.n(g),y=n(74),_=n.n(y),D=n(76),M=n.n(D),w=n(183);var k=function(e){var t=e.addressObj,n=e.time;return Object(p.jsxs)("div",{className:"time",children:[Object(p.jsx)(L,{addressObj:t,time:n}),Object(p.jsx)("p",{children:O(n.timestamp_start)}),Object(p.jsx)("p",{children:b(n.timestamp_start)}),Object(p.jsxs)("p",{children:[u(n.timestamp_start),"-",u(n.timestamp_end)]})]})},L=function(e){var t=e.time;return Object(p.jsx)("div",{className:"save-to-calendar",children:Object(p.jsx)("a",{target:"_blank",rel:"noreferrer",href:t.schedulingUrl,children:Object(p.jsx)(M.a,{})})})},S=function(e){var t=e.addressObj,n=Object(s.useContext)(m),r=n.onMouseAddressHover,c=n.onMouseAddressOut,a=n.setAddressesObjets,d=Object(s.useState)(!1),j=Object(i.a)(d,2),u=j[0],b=j[1],O=Object(s.useContext)(h).setMapCenter,f=t.address.unformatted.toString().includes('\u05de\u05d3"\u05d0');return Object(p.jsxs)("div",{dir:"rtl",onMouseEnter:function(){r(t)},onMouseLeave:function(){c(t)},className:f?"address__mada":"address",children:[Object(p.jsxs)("div",{id:"click__to__center__map",onClick:function(){a((function(e){return e.map((function(e){return e===t?Object(l.a)(Object(l.a)({},t),{},{isLocationClicked:!0}):Object(l.a)(Object(l.a)({},e),{},{isLocationClicked:!1})}))})),!o.isMobile&&o.isBrowser&&O([t.address.location.lat,t.address.location.lng])},children:[Object(p.jsx)("h3",{children:t.address.city}),Object(p.jsx)("p",{children:t.address.unformatted}),Object(p.jsx)(k,{addressObj:t,time:t.times[0]})]}),u&&t.times.map((function(e,n){if(0!==n)return Object(p.jsx)(k,{addressObj:t,time:e},e.timestamp_start)})),Object(p.jsxs)("div",{children:[u&&t.times.length>1&&Object(p.jsxs)(w.a,{onClick:function(){b(!1)},size:"small",color:"primary",variant:"contained",children:[Object(p.jsx)(_.a,{color:"secondary",onClick:function(){return b(!0)}}),"\u05e4\u05d7\u05d5\u05ea \u05ea\u05d0\u05e8\u05d9\u05db\u05d9\u05dd"]}),!u&&t.times.length>1&&Object(p.jsxs)(w.a,{onClick:function(){b(!0)},size:"small",color:"primary",variant:"contained",children:[Object(p.jsx)(C.a,{color:"secondary",onClick:function(){return b(!0)}}),"\u05dc\u05e2\u05d5\u05d3 \u05ea\u05d0\u05e8\u05d9\u05db\u05d9\u05dd"]})]})]})},E=[0,10,20,30,40,50,60];var A=function(){var e=Object(s.useContext)(m),t=e.addressesObjects,n=e.setAllAddressesObjects,r=Object(s.useContext)(h).locationsCenter;return Object(s.useEffect)((function(){t&&n((function(e){var t=[].concat(e);return t.sort((function(e,t){if(!e.address.location||!t.address.location)return 1;for(var n=d(e.address.location.lat,e.address.location.lng,r[0],r[1]),s=d(t.address.location.lat,t.address.location.lng,r[0],r[1]),c=0,a=0,i=0;i<E.length-1;i++)n>E[i]&&n<E[i+1]&&(c=i),s>E[i]&&s<E[i+1]&&(a=i);return n>E[E.length-1]&&(c=E.length-1),s>E[E.length-1]&&(a=E.length-1),c===a&&c!==E.length-1?e.times[0].timestamp_start<t.times[0].timestamp_start?-1:1:n<s?-1:1})),t}))}),[r]),t?Object(p.jsx)("div",{id:"addresses",children:t.map((function(e,t){if(!(t>20))return e?Object(p.jsx)(S,{addressObj:e},t):void 0}))}):Object(p.jsx)("div",{children:"Loading Locations..."})},P=n(184),H=n(185),z=n(195),N=n(192),B=n(196),I=n(186),T=n(187);n(105);var Z=function(e){var t=e.address,n=e.times;return Object(p.jsxs)("div",{className:"table__container",children:[Object(p.jsx)("h3",{dir:"rtl",children:t}),Object(p.jsx)("br",{}),Object(p.jsxs)("table",{dir:"rtl",className:"minimalistBlack",children:[Object(p.jsx)("thead",{children:Object(p.jsxs)("tr",{children:[Object(p.jsx)("th",{children:"\u05ea\u05d0\u05e8\u05d9\u05da"}),Object(p.jsx)("th",{children:"\u05d9\u05d5\u05dd"}),Object(p.jsx)("th",{children:"\u05e9\u05e2\u05d5\u05ea"})]})}),Object(p.jsx)("tbody",{children:n.map((function(e){var t=O(e.timestamp_start),n=b(e.timestamp_start),s=u(e.timestamp_start),r=u(e.timestamp_end);return Object(p.jsxs)("tr",{children:[Object(p.jsx)("td",{children:t}),Object(p.jsx)("td",{children:n}),Object(p.jsx)("td",{children:"".concat(s,"-").concat(r)})]},e.timestamp_start)}))})]})]})};n(106);function R(){var e=Object(P.a)(),t=Object(s.useContext)(h),n=t.mapCenter,r=t.locationsCenter,c=t.mapZoom;t.setCenterToCurrentLocation;return Object(s.useEffect)((function(){e.closePopup(),e.setView(n)}),[r,n]),Object(s.useEffect)((function(){r&&c&&e.setView(r,c)}),[r,c]),Object(p.jsx)(p.Fragment,{})}var V=function(){var e=Object(s.useContext)(m),t=e.addressesObjects,n=e.setAddressesObjets,r=Object(s.useContext)(h),c=r.mapCenter,a=r.mapZoom;return t?Object(p.jsx)("div",{children:Object(p.jsxs)(H.a,{center:c,zoom:a,scrollWheelZoom:!0,tap:!1,children:[Object(p.jsx)(R,{}),Object(p.jsx)(z.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),t.map((function(e,t){e.address.unformatted;var s=e.address.location;return s?Object(p.jsxs)("div",{children:[Object(p.jsx)(N.a,{children:Object(p.jsx)(B.a,{pathOptions:e.isPopupOpen||e.isListHovered||e.isLocationClicked?{color:"red",opacity:"1"}:{color:"green",opacity:.2},radius:20,center:[s.lat,s.lng]},t+"circle")}),Object(p.jsx)(I.a,{position:s,riseOnHover:!0,riseOffset:250,autoPan:!0,children:Object(p.jsx)(T.a,{onOpen:function(){!function(e){n((function(t){return t.map((function(t){return t===e?Object(l.a)(Object(l.a)({},e),{},{isPopupOpen:!0,isLocationClicked:!1}):Object(l.a)(Object(l.a)({},t),{},{isLocationClicked:!1})}))}))}(e)},onClose:function(){!function(e){n((function(t){return t.map((function(t){return t===e?Object(l.a)(Object(l.a)({},e),{},{isPopupOpen:!1}):t}))}))}(e)},children:Object(p.jsx)(Z,{address:e.address.unformatted,times:e.times})})},t)]},t):void 0}))]})}):Object(p.jsx)("div",{children:"Loading Map..."})},q=n(66),F=n.n(q),J=n(191),W=n(197),G=n(188);n(107),n(108);var U=function(){var e=Object(s.useContext)(m),t=e.startDate,n=e.setStartDate,r=e.endDate,c=e.setEndDate,a=Object(s.useState)("\u05d1\u05d7\u05e8\u05d5 \u05ea\u05d0\u05e8\u05d9\u05da \u05d4\u05ea\u05d7\u05dc\u05d4"),o=Object(i.a)(a,2),d=o[0],j=o[1],l=Object(s.forwardRef)((function(e,t){var n=e.value,s=e.onClick;return Object(p.jsx)("div",{className:"datepicker__input",onClick:s,ref:t,children:n||"\u05d5\u05d1\u05ea\u05d0\u05e8\u05d9\u05db\u05d9\u05dd..."})}));return Object(p.jsxs)("div",{id:"datepicker",children:[Object(p.jsx)(F.a,{dateFormat:"dd/MM/yyyy",locale:J.a,selected:t,onChange:function(e){var t=Object(i.a)(e,2),s=t[0],r=t[1];n(s),c(r),j(r?"\u05d1\u05d7\u05e8\u05d5 \u05ea\u05d0\u05e8\u05d9\u05da \u05d4\u05ea\u05d7\u05dc\u05d4":"\u05d1\u05d7\u05e8\u05d5 \u05ea\u05d0\u05e8\u05d9\u05da \u05e1\u05d9\u05d5\u05dd")},startDate:t,endDate:r,selectsRange:!0,calendarContainer:function(e){var t=e.className,n=e.children;return Object(p.jsxs)(q.CalendarContainer,{className:t,children:[Object(p.jsx)("div",{className:"datepicker__header",children:d}),Object(p.jsx)("div",{style:{position:"relative"},children:n})]})},customInput:Object(p.jsx)(l,{}),highlightDates:[(new Date).getDate(),1],popperPlacement:"bottom"}),t||r?Object(p.jsx)(G.a,{onClick:function(){n(null),c(null)},size:"small",color:"primary",variant:"contained",children:Object(p.jsx)(W.a,{color:"primary",size:"small"})}):Object(p.jsx)(p.Fragment,{})]})},X=n(67),K=n.n(X),Q=n(79),Y=n(190),$=n(194),ee=n(80),te=n.n(ee);var ne=function(){var e=Object(s.useContext)(h).setCenterToCurrentLocation;return Object(p.jsx)(G.a,{onClick:function(){e();var t=document.getElementById("addresses");t&&(t.scrollTop=0)},size:"small",color:"primary",variant:"contained",children:Object(p.jsx)(te.a,{color:"primary",size:"small"})})};n(150);var se=function(){var e=Object(s.useState)([]),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(s.useContext)(h),a=c.setMapCenter,o=c.setMapZoom,d=c.setLocationsCenter,j=Object($.a)({limit:10});return Object(s.useEffect)((function(){(function(){var e=Object(Q.a)(K.a.mark((function e(){var t,n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://raw.githubusercontent.com/orianshechter/blood-donation-addresses/main/cities.json");case 2:if((t=e.sent).ok){e.next=6;break}return console.log("failed to fetch cities"),e.abrupt("return");case 6:return e.next=8,t.json();case 8:n=e.sent,console.log({data:n}),r(n);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[]),Object(p.jsxs)("div",{dir:"rtl",id:"search__bar",children:[Object(p.jsx)(Y.a,{options:n,getOptionLabel:function(e){return e.name},filterOptions:j,onChange:function(e,t){if(t){var n=document.getElementById("addresses");n&&(n.scrollTop=0),a([t.lat,t.long]),d([t.lat,t.long]),o(11)}},renderInput:function(e){return Object(p.jsx)("div",{ref:e.InputProps.ref,children:Object(p.jsx)("input",Object(l.a)({style:{border:"10px",outlineWidth:"0",borderRadius:"99px",width:"100%",fontSize:"20px"},placeholder:"\u05d0\u05e0\u05d9 \u05e8\u05d5\u05e6\u05d4 \u05dc\u05ea\u05e8\u05d5\u05dd \u05d3\u05dd \u05d1..",type:"text"},e.inputProps))})}}),Object(p.jsx)(ne,{})]})},re=n(193),ce=n(189);var ae=function(e){var t=e.setMainBodyDisplay;return Object(p.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between",fontSize:"larger",alignItems:"center",padding:"6px"},children:["\u05d4\u05e6\u05d2 \u05dc\u05e4\u05d9:",Object(p.jsx)("div",{style:{padding:"5px"},dir:"ltr",children:Object(p.jsxs)(ce.a,{"aria-label":"Basic example",children:[Object(p.jsx)(re.a,{onClick:function(){t("map")},variant:"primary",children:"\u05de\u05e4\u05d4"}),Object(p.jsx)(re.a,{onClick:function(){t("locations")},variant:"primary",children:"\u05e8\u05e9\u05d9\u05de\u05ea \u05db\u05ea\u05d5\u05d1\u05d5\u05ea"})]})})]})};n(151);var ie=function(){var e=Object(s.useState)("locations"),t=Object(i.a)(e,2),n=t[0],r=t[1];return Object(p.jsx)(v,{children:Object(p.jsxs)(f,{children:[Object(p.jsx)(o.BrowserView,{children:Object(p.jsxs)("div",{id:"app",children:[Object(p.jsxs)("div",{id:"page__header",children:[Object(p.jsx)(se,{}),Object(p.jsx)(U,{})]}),Object(p.jsxs)("div",{dir:"ltr",id:"page__body",children:[Object(p.jsx)(V,{}),Object(p.jsx)(A,{})]})]})}),Object(p.jsx)(o.MobileView,{children:Object(p.jsxs)("div",{id:"app",children:[Object(p.jsx)(se,{}),Object(p.jsx)(U,{}),Object(p.jsx)(ae,{setMainBodyDisplay:r}),Object(p.jsxs)("div",{dir:"ltr",id:"page__body",children:["map"===n&&Object(p.jsx)(V,{}),"locations"===n&&Object(p.jsx)(A,{})]})]})})]})})};a.a.render(Object(p.jsx)(r.a.StrictMode,{children:Object(p.jsx)(ie,{})}),document.getElementById("root"))},95:function(e,t,n){},96:function(e,t,n){},98:function(e,t,n){}},[[153,1,2]]]);
//# sourceMappingURL=main.583b53f9.chunk.js.map